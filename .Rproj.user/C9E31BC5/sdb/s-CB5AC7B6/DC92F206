{
    "contents" : "createEpsilonConstraint <- function(eb){\n  lhs <- matrix(c(1))\n  rownames(lhs) <- c(\"EC\")\n  colnames(lhs) <- c(\"e\")\n  dir <- matrix(c(\">=\"))\n  rownames(dir) <- c(\"EC\")\n  rhs <- matrix(MINEPS)\n  rownames(rhs) <- c(\"EC\")\n  eb$constr <- list(lhs=lhs, dir=dir, rhs=rhs)\n  eb$epsylonIndex <- 1\n  return(eb)\n}\n\ncreateB1Constraint <- function(etrib, nCrit) {\n  varnames <- c()\n  for(j in 1:nCrit){\n    name <- paste(\"w\",j, sep=\"\")\n    varnames = c(varnames, name)\n  }\n  etrib$constr$lhs <- etriutils.addVariables(etrib$constr$lhs, varnames)\n  \n  weigthConst <- matrix(0, ncol=ncol(etrib$constr$lhs), nrow=nrow(etrib$constr$lhs), dimnames=list(\"B1\"))\n  etrib$constr$lhs <- rbind(etrib$constr$lhs, weigthConst)\n  \n  for(name in varnames){\n    etrib$constr$lhs[nrow(etrib$constr$lhs), name] <- 1\n  } \n  \n  etrib$constr$rhs <- rbind(etrib$constr$rhs, matrix(1, ncol=1, nrow=1, dimnames=list(\"B1\")))\n  etrib$constr$dir <- rbind(etrib$constr$dir, matrix(\"==\", ncol=1, nrow=1, dimnames=list(\"B1\")))\n  \n  return(etrib)\n}\n\ncreateB2Constraint <- function(etrib, nCrit, nProf) {\n  varnames <- c()\n  for(i in 1:nCrit){\n    name <- paste0(\"c\", i, \"(b\", nProf-1, \", b0)\")\n    varnames = c(varnames, name)\n  }\n  etrib$B2StartIndex <- ncol(etrib$constr$lhs)\n  etrib$constr$lhs <- etriutils.addVariables(etrib$constr$lhs, varnames)\n  etrib$B2EndIndex <- ncol(etrib$constr$lhs)\n  \n  for(i in 1:nCrit){\n    cName <- paste0(\"c\", i, \"(b\", nProf-1, \", b0)\")\n    wName <- paste0(\"w\", i)\n    lhs <- matrix(0, nrow=1, ncol=ncol(etrib$constr$lhs), dimnames=list(\"B2\", colnames(etrib$constr$lhs)))\n    lhs[,cName] <- (-1)\n    lhs[,wName] <- 1\n    etrib$constr$lhs <- rbind(etrib$constr$lhs, lhs)\n    \n    etrib$constr$rhs <- rbind(etrib$constr$rhs, matrix(0, ncol=1, nrow=1, dimnames=list(\"B2\")))\n    etrib$constr$dir <- rbind(etrib$constr$dir, matrix(\"==\", ncol=1, nrow=1, dimnames=list(\"B2\")))\n  }\n  \n  return(etrib)\n}\n\ncreateB4Constraint <- function(etrib){\n  etrib$constr$lhs <- etriutils.addVariables(etrib$constr$lhs, c(\"L\"))\n  \n  lhs <- matrix(0, nrow=1, ncol=ncol(etrib$constr$lhs), dimnames=list(\"B4\", colnames(etrib$constr$lhs)))\n  lhs[,\"L\"] <- 1\n  etrib$constr$lhs <- rbind(etrib$constr$lhs, lhs)\n  etrib$constr$rhs <- rbind(etrib$constr$rhs, matrix(1, ncol=1, nrow=1, dimnames=list(\"B4\")))\n  etrib$constr$dir <- rbind(etrib$constr$dir, matrix(\"<=\", ncol=1, nrow=1, dimnames=list(\"B4\")))\n  \n  lhs <- matrix(0, nrow=1, ncol=ncol(etrib$constr$lhs), dimnames=list(\"B4\", colnames(etrib$constr$lhs)))\n  lhs[,\"L\"] <- 1\n  etrib$constr$lhs <- rbind(etrib$constr$lhs, lhs)\n  etrib$constr$rhs <- rbind(etrib$constr$rhs, matrix(0.5, ncol=1, nrow=1, dimnames=list(\"B4\")))\n  etrib$constr$dir <- rbind(etrib$constr$dir, matrix(\">=\", ncol=1, nrow=1, dimnames=list(\"B4\")))\n  return(etrib)\n}\n\ncreateB5Constraint <- function(etrib, nCrit){\n  for(j in 1:nCrit){\n    name <- paste0(\"w\",j)\n    lhs <- matrix(0, nrow=1, ncol=ncol(etrib$constr$lhs), dimnames=list(\"B5\", colnames(etrib$constr$lhs)))\n    lhs[,name] <- 1\n    etrib$constr$lhs <- rbind(etrib$constr$lhs, lhs)\n    etrib$constr$rhs <- rbind(etrib$constr$rhs, matrix(0, ncol=1, nrow=1, dimnames=list(\"B5\")))\n    etrib$constr$dir <- rbind(etrib$constr$dir, matrix(\">=\", ncol=1, nrow=1, dimnames=list(\"B5\")))\n    \n    lhs <- matrix(0, nrow=1, ncol=ncol(etrib$constr$lhs), dimnames=list(\"B5\", colnames(etrib$constr$lhs)))\n    lhs[,name] <- 1\n    etrib$constr$lhs <- rbind(etrib$constr$lhs, lhs)\n    etrib$constr$rhs <- rbind(etrib$constr$rhs, matrix(1, ncol=1, nrow=1, dimnames=list(\"B5\")))\n    etrib$constr$dir <- rbind(etrib$constr$dir, matrix(\"<=\", ncol=1, nrow=1, dimnames=list(\"B5\")))\n  }\n  return(etrib)\n}\n\ncreateB6Constraint <- function(etrib, performances, profiles,monotonicity, th){\n  nAlts <- nrow(performances)\n  nCats <- nrow(profiles)\n  nCrit <- ncol(performances)\n  varnames <- c()\n  \n  for (j in 1:nCrit) {\n    for (a in 1:nAlts) {\n      for (b in 1:nCats) {\n        varnames = c(varnames, paste0('c', j, '(a', a, ',b', b-1, ')'))\n      }\n    }\n  }\n  \n  for (j in 1:nCrit) {\n    for (b in 1:nCats) {    \n      for (a in 1:nAlts) {\n        varnames = c(varnames, paste0('c', j, '(b', b-1, ',a', a, ')'))\n      }\n    }\n  }\n  \n  etrib$constr$lhs <- etriutils.addVariables(constr=etrib$constr$lhs, names=varnames)\n  rownames <- paste0(\"B6.\", seq(1:length(varnames)))\n  lhs <- matrix(0, ncol=ncol(etrib$constr$lhs), nrow=length(varnames), dimnames=list(rownames, colnames(etrib$constr$lhs)))\n  \n  row <- 0\n  for (j in 1 : nCrit) {\n    for (aInd in 1 : nAlts) {\n      for (bInd in 1 : nCats) {\n        row = row + 1        \n        indAB <- paste0('c', j, '(a', aInd, ',b', bInd-1, ')')\n        lhs[row,indAB] = 1\n        lhs[row,paste0(\"w\",j)] = -1 *\n          outranking(performances[aInd,j], profiles[bInd,j],\n                     th[j,1], th[j,2], th[j, 3], th[j, 4], monotonicity[j])\n      }\n    }\n  }\n  \n  for (j in 1:nCrit) {\n    for (bInd in 1:nCats) {\n      for (aInd in 1:nAlts) {\n        row = row + 1        \n        indBA <- paste0('c', j, '(b', bInd-1, ',a', aInd, ')')  \n        lhs[row,indBA] = 1\n        val <- -1 * outranking(profiles[bInd,j], performances[aInd,j],\n                               th[j,1], th[j,2], th[j, 3], th[j, 4], monotonicity[j])\n        lhs[row,paste0(\"w\",j)] = val\n      }\n    }\n  }\n  \n  etrib$constr$lhs <- rbind(etrib$constr$lhs, lhs)\n  \n  rownames(lhs) <- rownames\n  dir <- matrix(\"==\", nrow=row, ncol=1)\n  rownames(dir) <- rownames\n  etrib$constr$dir <- rbind(etrib$constr$dir, dir)\n  rhs <- matrix(0, nrow=length(varnames), ncol=1)\n  rownames(rhs) <- rownames\n  etrib$constr$rhs <- rbind(etrib$constr$rhs, rhs)\n  \n  return(etrib)\n}\n\n## p is preference threshold\n## q is indifference threshold\noutranking <- function(x, y, q, qMult, p, pMult, ascending) {\n  stopifnot(p >= 0 && q >= 0 && p >= q)\n  diff <- y - x\n  if (ascending == FALSE) {\n    diff = 0 - diff\n  }\n  \n  indif <- q + qMult * x\n  pref <- p + pMult * x\n  \n  if (diff <= indif) {\n    return (1)\n  } else if (diff >= pref) {\n    return(0)\n  } else {\n    return ((pref-diff) / (pref - indif))\n  }\n}\n",
    "created" : 1400802832894.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "226592747",
    "id" : "DC92F206",
    "lastKnownWriteTime" : 1401050084,
    "path" : "C:/Users/Patryk/Desktop/Praca Magisterska/ELECTRE TRI B/etrib/etribbase.R",
    "project_path" : "etribbase.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}